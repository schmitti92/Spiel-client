<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Barikade</title>

  <!-- Deine CSS Datei (muss im gleichen Ordner liegen) -->
  <link rel="stylesheet" href="styles.css" />

  <style>
    /* Minimal-Layout, damit alles sichtbar bleibt, auch wenn styles.css mal fehlt */
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; background:#0b0f16; color:#e6edf3; }
    .app { display:grid; grid-template-columns: 1fr 380px; gap:16px; padding:16px; }
    @media (max-width: 900px){ .app { grid-template-columns: 1fr; } }

    .topbar { display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px 16px; border-bottom:1px solid rgba(255,255,255,.08); }
    .brand { display:flex; flex-direction:column; gap:2px; }
    .brand .t { font-weight:900; font-size:18px; }
    .brand .s { opacity:.75; font-size:12px; }

    .rightActions { display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    .pill { display:flex; align-items:center; gap:8px; padding:10px 12px; border-radius:999px; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.10); }
    .dot { width:10px; height:10px; border-radius:50%; background:#666; display:inline-block; }
    .btn { padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.06); color:#e6edf3; font-weight:700; cursor:pointer; }
    .btn:disabled { opacity:.45; cursor:not-allowed; }

    .boardWrap { border-radius:18px; border:1px solid rgba(255,255,255,.08); background:rgba(255,255,255,.03); overflow:hidden; min-height:520px; }
    canvas { width:100%; height:620px; display:block; touch-action:none; }

    .panel { border-radius:18px; border:1px solid rgba(255,255,255,.08); background:rgba(255,255,255,.03); padding:14px; }
    .panel h3 { margin:6px 0 12px 0; font-size:16px; }
    .row { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .dicePill { margin-left:auto; width:66px; height:66px; border-radius:14px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.04); display:flex; align-items:center; justify-content:center; overflow:hidden; }
    #diceCube { width:54px; height:54px; }
    #toast { position:fixed; left:50%; bottom:22px; transform:translateX(-50%); padding:10px 14px; border-radius:14px; background:rgba(0,0,0,.72); border:1px solid rgba(255,255,255,.14); opacity:0; pointer-events:none; transition:.15s; z-index:9999; }
    #toast.show { opacity:1; }
    #netBanner { position:fixed; top:14px; left:50%; transform:translateX(-50%); padding:10px 14px; border-radius:14px; background:rgba(0,0,0,.72); border:1px solid rgba(255,255,255,.14); opacity:0; pointer-events:none; transition:.15s; z-index:9999; max-width:min(92vw,900px); }
    #netBanner.show { opacity:1; pointer-events:auto; }

    #debugLog { display:none; margin-top:10px; padding:10px; border-radius:12px; background:rgba(0,0,0,.35); border:1px solid rgba(255,255,255,.10); white-space:pre-wrap; max-height:180px; overflow:auto; font-size:12px; }

    /* Overlay */
    #overlay { position:fixed; inset:0; background:rgba(0,0,0,.66); display:none; align-items:center; justify-content:center; z-index:9998; }
    #overlay.show { display:flex; }
    .overlayCard { width:min(520px,92vw); border-radius:18px; background:#101521; border:1px solid rgba(255,255,255,.12); padding:16px; }
    .overlayCard h2 { margin:0 0 8px 0; }
    .overlayCard p { margin:6px 0; opacity:.85; }
    .kv { display:flex; justify-content:space-between; gap:10px; padding:6px 0; border-bottom:1px solid rgba(255,255,255,.06); }
    .joker-grid { display:grid; grid-template-columns: 1fr; gap:10px; margin-top:10px; }
    .joker-btn { padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.06); color:#e6edf3; font-weight:800; cursor:pointer; }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="brand">
      <div class="t">Barikade</div>
      <div class="s">Online ¬∑ Server steuert W√ºrfel + Z√ºge ¬∑ 2‚Äì3 Spieler</div>
    </div>

    <div class="rightActions">
      <div class="pill"><span id="turnDot" class="dot"></span> <span id="turnText">‚Äì</span></div>
      <button id="endBtn" class="btn">Zug beenden</button>
      <button id="skipBtn" class="btn">Runde aussetzen</button>
      <button id="resetBtn" class="btn">Reset</button>
    </div>
  </div>

  <div class="app">
    <div class="boardWrap">
      <canvas id="c"></canvas>
    </div>

    <div class="panel">
      <!-- W√ºrfel -->
      <h3>W√ºrfel</h3>
      <div class="row">
        <button id="rollBtn" class="btn">W√ºrfeln</button>
        <div class="dicePill">
          <!-- Der W√ºrfel selbst (dein game.js setzt data-face) -->
          <div id="diceCube" data-face="1"></div>
        </div>
      </div>

      <!-- Joker / Action -->
      <div style="height:14px"></div>
      <h3>Joker</h3>
      <div class="row" style="justify-content:space-between;">
        <label style="display:flex;align-items:center;gap:10px;opacity:.9;">
          <input id="actionModeToggle" type="checkbox" />
          Action-Modus (Joker-Extra)
        </label>
        <button id="debugToggle" class="btn" style="margin-left:auto;">Debug</button>
      </div>

      <div id="actionCard" style="display:none; margin-top:12px;">
        <div id="actionHint" style="opacity:.85; font-size:13px; margin-bottom:10px;">Action-Modus aktiv</div>

        <div id="jokerAwardModeBox" class="awardmode-box">
          <div class="awardmode-title">Joker bei Rausschmei√üen</div>
          <label class="awardmode-option">
            <input type="radio" name="jokerAwardMode" id="jokerAwardThrower" value="thrower">
            Werfer bekommt den Joker
          </label>
          <label class="awardmode-option">
            <input type="radio" name="jokerAwardMode" id="jokerAwardVictim" value="victim">
            Opfer bekommt den Joker
          </label>
          <div id="jokerAwardModeHint" class="awardmode-hint"></div>
        </div>


        <!-- Statuszeilen (IDs m√ºssen existieren, game.js versteckt ggf. choose/sum nur optisch) -->
        <div class="kv"><span>üéØ Choose</span><span id="jokerChooseState">‚Äì</span></div>
        <div class="kv"><span>‚ûï Summe</span><span id="jokerSumState">‚Äì</span></div>
        <div class="kv"><span>üåà Alle Farben</span><span id="jokerAllColorsState">‚Äì</span></div>
        <div class="kv"><span>üß± Barikade</span><span id="jokerBarricadeState">‚Äì</span></div>
        <div class="kv"><span>üîÅ Neu-Wurf</span><span id="jokerRerollState">‚Äì</span></div>
        <div class="kv"><span>‚ú® Effekte</span><span id="actionEffectsState">‚Äì</span></div>

        <div class="joker-grid">
          <button id="jokerAllColorsBtn" class="joker-btn" type="button">üåà Alle Farben nutzen</button>
          <button id="jokerBarricadeBtn" class="joker-btn" type="button">üß± Barikade nutzen</button>
          <!-- reroll/double Buttons werden von game.js additiv injiziert -->
        </div>
      </div>

      <pre id="debugLog"></pre>

      <!-- Status -->
      <div style="height:16px"></div>
      <h3>Status</h3>
      <div class="kv"><span>Board</span><span id="boardInfo">‚Äì</span></div>
      <div class="kv"><span>Barikaden</span><span id="barrInfo">‚Äì</span></div>

      <!-- Online -->
      <div style="height:16px"></div>
      <h3>Online</h3>
      <div style="opacity:.75; font-size:13px; line-height:1.35; margin-bottom:10px;">
        Server ist fest hinterlegt. Du brauchst nur noch einen Raumcode.
      </div>
      <div class="kv"><span>Server</span><span id="serverLabel">‚Äì</span></div>

      <div class="row" style="margin-top:10px;">
        <input id="roomCode" placeholder="Raumcode" style="flex:1; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.04); color:#e6edf3;" />
      </div>

      <div class="row" style="margin-top:10px;">
        <button id="hostBtn" class="btn">Host</button>
        <button id="joinBtn" class="btn">Beitreten</button>
        <button id="leaveBtn" class="btn">Trennen</button>
      </div>

      <div class="kv" style="margin-top:10px;"><span>Status</span><span id="netStatus">Offline</span></div>
      <div class="kv"><span>Spieler</span><span id="netPlayers">‚Äì</span></div>
      <div class="kv"><span>Meine Farbe</span><span id="myColor">‚Äì</span></div>

      <!-- Host Tools (m√ºssen existieren, game.js blendet sie host-only ein) -->
      <div id="hostTools" class="row" style="display:none; margin-top:12px;">
        <button id="saveBtn" class="btn">Save</button>
        <button id="loadBtn" class="btn">Load</button>
        <button id="restoreBtn" class="btn">Restore</button>
        <input id="loadFile" type="file" accept="application/json" style="display:none;" />
      </div>
      <div id="autoSaveInfo" style="display:none; margin-top:8px; opacity:.75; font-size:12px;">Auto-Save: ‚Äì</div>

      <!-- Resume (optional, wird genutzt) -->
      <div class="row" style="margin-top:12px;">
        <button id="startBtn" class="btn">Spiel starten</button>
        <button id="resumeBtn" class="btn">Spiel fortsetzen</button>
      </div>
    </div>
  </div>

  <!-- Toast & Banner -->
  <div id="toast"></div>
  <div id="netBanner"></div>

  <!-- Overlay -->
  <div id="overlay">
    <div class="overlayCard">
      <h2 id="overlayTitle">‚Äì</h2>
      <p id="overlaySub">‚Äì</p>
      <p id="overlayHint">‚Äì</p>
      <div class="row" style="justify-content:flex-end; margin-top:12px;">
        <button id="overlayOk" class="btn">OK</button>
      </div>
    </div>
  </div>

  <!-- WICHTIG: game.js muss exakt so hei√üen und im gleichen Ordner liegen -->
  <script src="game.js"></script>
</body>
</html>
