<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Lichtarena (Offline)</title>
  <link rel="stylesheet" href="lichtarena.css?v=1" />
  <style>
    .topActions{ display:flex; gap:10px; align-items:center; }
    /* Debug overlay (Tablet ohne Konsole) */
    .debugOverlay{ position:fixed; inset:16px; background:rgba(8,10,14,.92);
      border:1px solid rgba(255,255,255,.12); border-radius:16px;
      box-shadow:0 20px 80px rgba(0,0,0,.55); z-index:9999;
      display:flex; flex-direction:column; }
    .debugHeader{ display:flex; align-items:center; justify-content:space-between;
      padding:12px 14px; border-bottom:1px solid rgba(255,255,255,.10); }
    .debugTitle{ font-weight:700; opacity:.95; }
    .debugClose{ appearance:none; border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06); color:#fff; padding:8px 10px;
      border-radius:12px; cursor:pointer; }
    .debugText{ margin:0; padding:12px 14px; overflow:auto; white-space:pre-wrap;
      font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:12px; line-height:1.35; }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="title">Lichtarena</div>
      <div class="subtitle">Prototype ‚Äì Offline (saubere Basis)</div>
    </div>

    <div class="pills" id="pills">
      <span class="pill" id="pillMode">Modus: Offline lokal</span>
      <span class="pill" id="pillBoard">Board: ‚Äì</span>
      <span class="pill" id="pillRule">Regel: Sammle 5 Lichter global ‚Üí Board 2</span>
      <span class="pill pillTurn" id="pillTurn">Am Zug: ‚Äì</span>
    </div>

    <div class="topActions">
      <button class="uiBtn" id="btnToggleUI" title="UI ein-/ausblenden">‚â° UI</button>
      <button class="uiBtn" id="btnDebug" title="Debug-Overlay (f√ºr Tablet ohne Konsole)">üêû</button>
    </div>
  </header>

  <!-- Debug Overlay (zeigt JS-Fehler & Logs direkt im Spiel) -->
  <div id="debugOverlay" class="debugOverlay" hidden>
    <div class="debugHeader">
      <div class="debugTitle">Debug</div>
      <button id="btnDebugClose" class="debugClose">Schlie√üen</button>
    </div>
    <pre id="debugText" class="debugText"></pre>
  </div>

  <main class="layout" id="layout">
    <aside class="side" id="side">
      <section class="card">
        <h3>Spiel</h3>
        <div class="row">
          <div class="lbl">Spieler</div>
          <div class="val" id="hudPlayer">‚Äì</div>
        </div>
        <div class="row">
          <div class="lbl">W√ºrfel</div>
          <div class="val mono"><span id="hudDice">‚Äì</span></div>
        </div>
        <div class="row">
          <button class="btn primary" id="btnRoll">W√ºrfeln</button>
          <button class="btn" id="btnEndTurn">Zug beenden</button>
        </div>
        <div class="hint" id="hudHint">Tip: W√ºrfeln ‚Üí Figur w√§hlen ‚Üí Ziel anklicken (exakt W√ºrfel-Schritte, nur vorw√§rts).</div>
      </section>

      <section class="card">
        <h3>Licht</h3>
        <div class="row">
          <div class="lbl">Aktiv</div>
          <div class="val mono"><span id="hudActiveLights">0</span></div>
        </div>
        <div class="row">
          <div class="lbl">Global</div>
          <div class="val mono"><span id="hudGlobal">0</span>/<span id="hudGoal">5</span></div>
        </div>
        <div class="players" id="playersPanel"></div>
      </section>

      <section class="card">
        <h3>Joker (pro Spieler)</h3>
        <div class="jokerTable" id="jokerTable"></div>
        <div class="hint">Start: 2√ó je Joker. Bei Rauswurf dreht das Gl√ºcksrad (5s) ‚Üí aktiver Spieler gewinnt 1 Joker.</div>
      </section>

      <section class="card">
        <h3>Ansicht</h3>
        <div class="row">
          <button class="btn" id="btnFit">Fit</button>
          <button class="btn" id="btnResetView">Reset</button>
          <button class="btn" id="btnToggleLines">Linien: AUS</button>
        </div>
        <div class="hint">Touch: 1 Finger ziehen = verschieben ¬∑ 2 Finger = pinch-zoom ¬∑ Maus: Scroll = zoom</div>
      </section>

      <section class="card">
        <h3>Local</h3>
        <div class="row">
          <button class="btn" id="btnRestart">Restart</button>
          <button class="btn" id="btnSave">Save</button>
          <button class="btn" id="btnLoad">Load</button>
        </div>
        <div class="status" id="statusLine">Status: <span class="good">Lade‚Ä¶</span></div>
      </section>
    </aside>

    <section class="boardShell" id="boardShell">
      <div class="stage" id="stage">
        <svg class="edges" id="edgesSvg" xmlns="http://www.w3.org/2000/svg"></svg>
      </div>
    </section>
  </main>

  <!-- Gl√ºcksrad Modal -->
  <div class="modal hidden" id="wheelModal" role="dialog" aria-modal="true">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle">Gl√ºcksrad ‚Äì Joker Gewinn</div>
        <button class="iconBtn" id="btnWheelClose" title="Schlie√üen">‚úï</button>
      </div>
      <canvas id="wheelCanvas" width="520" height="520"></canvas>
      <div class="modalFoot">
        <div class="mono" id="wheelResult">‚Äì</div>
      </div>
    </div>
  </div>

  <!-- Board Complete Modal -->
  <div class="modal hidden" id="doneModal" role="dialog" aria-modal="true">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle">Board 1 geschafft üéâ</div>
        <button class="iconBtn" id="btnDoneClose" title="Schlie√üen">‚úï</button>
      </div>
      <div class="modalBody">
        Global wurden 5 Lichter gesammelt. N√§chster Schritt: Board 2 laden.
      </div>
      <div class="modalFoot">
        <button class="btn primary" id="btnGoBoard2">Weiter zu Board 2</button>
      </div>
    </div>
  </div>

  <script src="lichtarena_client.js?v=1"></script>
</body>
</html>
