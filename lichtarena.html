<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Lichtarena (Prototype – Offline)</title>
  <link rel="stylesheet" href="./lichtarena.css?v=1" />
</head>
<body>
  <header class="topbar">
    <div class="topbar-left">
      <div class="title">Lichtarena (Prototype – Offline)</div>
      <div class="subtitle">
        Klick auf eine Figur → auswählen. Dann auf ein verbundenes Feld klicken → Zug (1 Schritt). Tore/Gates werden beim Zug geprüft (Würfel muss passen). Licht spawnt zufällig auf freien normalen Feldern.
      </div>
    </div>

    <div class="topbar-right">
      <span class="pill">Modus: <b>Offline lokal</b></span>
      <span class="pill">Regel: <b>Board 1 startet mit Licht auf allen Lichtfeldern</b></span>
      <span class="pill turn-pill">Am Zug: <b id="turnColor">RED</b></span>
      <span class="pill subtle">Server-ready: später leicht umstellbar</span>
    </div>
  </header>

  <main class="layout">
    <!-- Board -->
    <section class="boardCard">
      <div class="boardTop">
        <div id="statusLine" class="statusLine">Status: –</div>

        <div class="miniHint">
          <div class="hintTitle">Zoom &amp; Move</div>
          <div class="hintText">
            <b>Touch:</b> 1 Finger ziehen = verschieben • 2 Finger = pinch-zoom<br/>
            <b>Maus:</b> Scroll = zoom • Linksklick ziehen = verschieben
          </div>
        </div>
      </div>

      <div class="boardViewport" id="boardViewport" aria-label="Spielfeld">
        <div class="boardPanZoom" id="boardPanZoom">
          <svg id="edgesSvg" class="edgesSvg" xmlns="http://www.w3.org/2000/svg"></svg>
          <div id="stage" class="stage" aria-hidden="false"></div>
        </div>
      </div>

      <div class="boardFooter">
        <button id="fitBtn" class="btn ghost">Fit</button>
        <button id="zoomOut" class="btn ghost">−</button>
        <div class="zoomReadout"><span id="zoomPct">100%</span></div>
        <button id="zoomIn" class="btn ghost">+</button>

        <div class="spacer"></div>

        <button id="btnToggleEdges" class="btn ghost">Linien: AUS</button>
      </div>
    </section>

    <!-- Sidebar -->
    <aside class="side">
      <!-- Turn -->
      <section class="panel">
        <div class="panelHead">
          <div class="panelTitle">Spieler</div>
          <div class="panelBadge"><span class="dot" data-dot="turn"></span><b id="turnColor2">RED</b></div>
        </div>
        <div class="panelBody row">
          <button id="btnPrevTurn" class="btn">◀</button>
          <button id="btnNextTurn" class="btn">▶</button>
          <div class="help">Wechselt den aktiven Spieler (offline Test).</div>
        </div>
      </section>

      <!-- Dice -->
      <section class="panel">
        <div class="panelHead">
          <div class="panelTitle">Würfel</div>
          <div class="panelBadge">Aktuell: <b id="hudDice">6</b></div>
        </div>
        <div class="panelBody grid2">
          <button id="btnRoll" class="btn primary">Würfeln</button>
          <div class="field">
            <label for="diceValue">Wert (1–6)</label>
            <input id="diceValue" type="number" inputmode="numeric" min="1" max="6" value="6" />
          </div>
        </div>
      </section>

      <!-- Lights -->
      <section class="panel">
        <div class="panelHead">
          <div class="panelTitle">Licht</div>
          <div class="panelBadge">
            Aktiv: <b id="hudActiveLights">0</b> • Gesammelt: <b id="hudLightTotal">0</b>/<b id="hudLightGoal">5</b>
          </div>
        </div>
        <div class="panelBody">
          <button id="btnForceSpawnLight" class="btn">Test: Licht spawnen</button>
          <div class="help">Regel: Wenn kein Licht mehr aktiv ist, spawnt zufällig ein neues auf einem freien normalen Feld.</div>
        </div>
      </section>

      <!-- Events -->
      <section class="panel">
        <div class="panelHead">
          <div class="panelTitle">Ereignis</div>
          <div class="panelBadge">Barikaden</div>
        </div>
        <div class="panelBody grid2">
          <button id="btnSpawnBarricade" class="btn danger">Barikade spawnen</button>
          <button id="btnClearDynamicBarricades" class="btn">Barikaden löschen</button>
        </div>
      </section>

      <!-- Jokers -->
      <section class="panel">
        <div class="panelHead">
          <div class="panelTitle">Joker (am Zug)</div>
          <div class="panelBadge">Start: 2× je Typ</div>
        </div>
        <div class="panelBody">
          <table class="jokerTable" aria-label="Jokerübersicht">
            <thead>
              <tr><th>Joker</th><th class="right">Anzahl</th></tr>
            </thead>
            <tbody id="jokerTable"></tbody>
          </table>
          <div class="help">Später: Buttons zum Einsetzen + Glücksrad bei Rausschmiss.</div>
        </div>
      </section>

      <!-- Debug -->
      <section class="panel">
        <div class="panelHead">
          <div class="panelTitle">Debug</div>
          <div class="panelBadge subtle">Local</div>
        </div>
        <div class="panelBody grid2">
          <button id="btnRestart" class="btn">Restart (Board neu laden)</button>
          <button id="btnSave" class="btn">Save Local</button>
          <button id="btnLoad" class="btn">Load Local</button>
        </div>
      </section>
    </aside>
  </main>

  <!-- Rules + Client -->
  <script src="./game_rules_lights_barricades.js?v=1"></script>
  <script src="./lichtarena_client.js?v=1"></script>
</body>
</html>
